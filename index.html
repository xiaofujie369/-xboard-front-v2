<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport"
        content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no">
  <title>å¯äº‘ Premium</title>

  <!-- ========== åŸºç¡€æ ·å¼ ========== -->
  <link rel="stylesheet" href="./assets/custom-theme.css" />

  <!-- ========== KY Popup v2 ç™»å½•åå…¬å‘Šå¼¹çª— ========== -->
  <style>
    .ky-popup-mask {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.4);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 99999;
      animation: fadeIn .3s ease forwards;
    }
    .ky-popup-box {
      background: rgba(255, 255, 255, 0.9);
      backdrop-filter: blur(10px);
      border-radius: 16px;
      padding: 24px;
      max-width: 420px;
      box-shadow: 0 10px 40px rgba(255, 182, 193, 0.4);
      animation: slideUp .4s ease;
      position: relative;
    }
    .ky-popup-box h2 {
      color: #ff6fae;
      font-size: 20px;
      margin-bottom: 12px;
      text-align: center;
    }
    .ky-popup-box p {
      color: #333;
      margin: 6px 0;
      font-size: 15px;
      line-height: 1.6;
      text-align: center;
    }
    .ky-popup-close {
      position: absolute;
      top: 10px;
      right: 16px;
      font-size: 22px;
      color: #999;
      cursor: pointer;
      transition: 0.2s;
    }
    .ky-popup-close:hover { color: #ff6fae; }
    .ky-popup-btn {
      background: linear-gradient(135deg, #ff85c1, #ff6fa8);
      border: none;
      border-radius: 8px;
      padding: 8px 20px;
      color: #fff;
      cursor: pointer;
      margin-top: 10px;
    }
    .ky-popup-btn:hover { opacity: 0.9; }

    @keyframes fadeIn { from {opacity: 0;} to {opacity: 1;} }
    @keyframes slideUp { from {transform: translateY(20px); opacity: 0;} to {transform: translateY(0); opacity: 1;} }
  </style>

  <script>
  (function () {
    console.log("å¯äº‘ KY Popup v2 loaded");
    const DASHBOARD_PATH = "/#/dashboard";
    let firstPopupDone = false, secondPopupDone = false, firstClosed = false;

    function showPopup() {
      if (document.querySelector('.ky-popup-mask')) return;
      const mask = document.createElement('div');
      mask.className = 'ky-popup-mask';
      mask.innerHTML = `
        <div class="ky-popup-box">
          <div class="ky-popup-close">Ã—</div>
          <h2>ğŸ“¢ æ–°äººå¿…çœ‹å…¬å‘Š</h2>
          <p>æ¬¢è¿æ¥åˆ°å¯äº‘ï¼Œè¯·åŠ¡å¿…é˜…è¯»é¡¶éƒ¨å…¬å‘Šæ ä¿¡æ¯ã€‚</p>
          <p>è¯·æ”¶è—æœ€æ–°åœ°å€ï¼š<b>shy521.com</b></p>
          <p>åŠ å…¥ TG ç¾¤ç»„ï¼š<a href="https://t.me/ss_keyun" target="_blank">t.me/ss_keyun</a></p>
          <button class="ky-popup-btn">æˆ‘å·²çŸ¥æ™“</button>
        </div>`;
      document.body.appendChild(mask);
      const close = () => {
        mask.remove();
        if (!firstClosed) {
          firstClosed = true;
          triggerSecondPopup();
        }
      };
      mask.querySelector(".ky-popup-close").onclick = close;
      mask.querySelector(".ky-popup-btn").onclick = close;
    }

    function randomDelay(min, max) {
      return Math.floor(Math.random() * (max - min + 1) + min) * 1000;
    }

    function triggerFirstPopup() {
      if (firstPopupDone) return;
      firstPopupDone = true;
      setTimeout(showPopup, randomDelay(3, 10));
    }

    function triggerSecondPopup() {
      if (secondPopupDone) return;
      secondPopupDone = true;
      setTimeout(() => {
        document.addEventListener("click", function once() {
          setTimeout(showPopup, randomDelay(3, 10));
          document.removeEventListener("click", once);
        });
      }, 60000);
    }

    function checkLoginAndStart() {
      if (location.href.includes(DASHBOARD_PATH)) {
        triggerFirstPopup();
      } else {
        requestAnimationFrame(checkLoginAndStart);
      }
    }

    window.addEventListener("load", checkLoginAndStart);
  })();
  </script>
</head>

<body>
  <noscript>
    <strong>æ‚¨çš„æµè§ˆå™¨æœªå¯ç”¨ JavaScriptï¼Œæ— æ³•åŠ è½½å¯äº‘ Premiumã€‚</strong>
  </noscript>

  <div id="app"></div>

  <!-- æ‰‹æœºç«¯å¢å¼º -->
  <script src="./mobile-enhance.js"></script>

  <!-- ä¸»ç¨‹åº umi.js åŠ è½½é€»è¾‘ -->
  <script>
    (function loadUmi() {
      const script = document.createElement("script");
      script.src = "./assets/umi.js";
      script.type = "text/javascript";
      script.onload = () => console.log("âœ… umi.js å·²æˆåŠŸåŠ è½½");
      script.onerror = () => {
        console.error("âŒ umi.js åŠ è½½å¤±è´¥ï¼Œæ£€æŸ¥è·¯å¾„ /assets/umi.js æ˜¯å¦å­˜åœ¨ã€‚");
        const msg = document.createElement("div");
        msg.style = "padding:40px;text-align:center;color:#ff4d6a;font-size:16px;";
        msg.innerHTML = "âŒ é¡µé¢åŠ è½½å¤±è´¥ï¼šæœªæ‰¾åˆ° umi.js<br>è¯·ç¡®è®¤è·¯å¾„ /assets/umi.js å­˜åœ¨ä¸”æ— å‹ç¼©é”™è¯¯ã€‚";
        document.body.appendChild(msg);
      };
      document.body.appendChild(script);
    })();
  </script>
</body>
</html>
