<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport"
        content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no">

  <title>å¯äº‘</title>

  <!-- å¼ºåˆ¶éªŒè¯ï¼ˆéªŒè¯å¤±è´¥ä¼šè‡ªåŠ¨è·³ verify.htmlï¼‰ -->
  <script>
    (function () {
      const verified = localStorage.getItem("cf_verified");

      // å¦‚æœæ²¡æœ‰é€šè¿‡éªŒè¯ â†’ è‡ªåŠ¨è·³è½¬ verify.html
      if (!verified) {
        if (!location.pathname.includes("verify.html")) {
          window.location.href = "/verify.html";
        }
      }
    })();
  </script>

  <!-- è‡ªå®šä¹‰ä¸»é¢˜ -->
  <link rel="stylesheet" href="/custom-theme.css">

  <!-- ç§»åŠ¨ç«¯æŠ˜å å¢å¼º -->
  <script defer src="/mobile-enhance.js"></script>

  <!-- Umi ä¸»æ¡†æ¶ï¼ˆæ…é‡å¿…é¡»åœ¨ HEADï¼‰ -->
  <script type="module" crossorigin src="/assets/umi.js"></script>
</head>

<body>
  <!-- ç«™ç‚¹ç¯å¢ƒé…ç½® -->
  <script src="/env.js"></script>

  <!-- â­ React çš„æŒ‚è½½ç‚¹ï¼ˆå¿…é¡»æ˜¯ rootï¼Œå¦åˆ™ç™½å±ï¼ï¼ï¼ï¼‰ -->
  <div id="root"></div>

  <!-- â­â­â­ å¼¹çª—ç³»ç»Ÿï¼ˆæœ€ç»ˆæ•´åˆç‰ˆï¼‰ â­â­â­ -->
  <script>
    (function () {
      console.log("å¯äº‘ Popup loaded");

      // é…ç½®
      const FIRST_DELAY = 3000;     // ç¬¬ä¸€æ¬¡å»¶è¿Ÿå¼¹çª—
      const CLICK_WINDOW = 60000;   // ç¬¬äºŒæ¬¡ç‚¹å‡»è§¦å‘ç›‘æ§

      let firstDone = false;
      let secondDone = false;
      let popupVisible = false;

      // åˆ›å»ºå¼¹çª—
      function showPopup() {
        if (popupVisible) return;
        popupVisible = true;

        const mask = document.createElement("div");
        mask.id = "kyPopupMask";
        mask.style.cssText = `
          position: fixed; inset: 0;
          background: rgba(0,0,0,.55);
          display:flex; justify-content:center; align-items:center;
          z-index:999999;
        `;

        const box = document.createElement("div");
        box.className = "ky-popup-box";
        box.style.cssText = `
          width: 320px; background:#fff; border-radius:16px;
          padding:22px; text-align:center; font-size:15px;
          box-shadow:0 4px 22px rgba(0,0,0,.15);
          position:relative;
        `;

        box.innerHTML = `
          <div class="ky-popup-close" style="
            position:absolute;right:14px;top:10px;
            font-size:22px;color:#999;cursor:pointer;">Ã—</div>

          <h2 style="font-size:20px;margin:10px 0 14px;color:#ff68a0;">ğŸ“¢ æ–°äººå¿…çœ‹å…¬å‘Š</h2>

          <p style="line-height:1.6;">æ¬¢è¿æ¥åˆ°å¯äº‘ï¼Œè¯·åŠ¡å¿…é˜…è¯»é¡¶éƒ¨å…¬å‘Šæ ä¿¡æ¯ã€‚</p>
          <p style="line-height:1.6;">è¯·æ”¶è—æœ€æ–°åœ°å€ï¼š<b>shy521.com</b></p>
          <p style="line-height:1.6;margin-bottom:18px;">
            åŠ å…¥ TG ç¾¤ç»„ï¼š<a href="https://t.me/ss_keyun" target="_blank">t.me/ss_keyun</a>
          </p>

          <button class="ky-popup-btn" style="
            background:#ff68a0;color:white;border:none;
            padding:10px 24px;border-radius:10px;
            font-size:15px;cursor:pointer;">æˆ‘å·²çŸ¥æ™“</button>
        `;

        mask.appendChild(box);
        document.body.appendChild(mask);

        const close = () => {
          popupVisible = false;
          mask.remove();
          onPopupClosed();
        };

        box.querySelector(".ky-popup-close").onclick = close;
        box.querySelector(".ky-popup-btn").onclick = close;
      }

      // å¼¹çª—å…³é—­åçš„é€»è¾‘
      function onPopupClosed() {
        if (!firstDone) {
          firstDone = true;
          startClickMonitor();
        } else if (!secondDone) {
          secondDone = true;
        }
      }

      // å¼€å¯ç¬¬äºŒæ¬¡ç‚¹å‡»ç›‘æ§
      function startClickMonitor() {
        const handler = () => {
          if (!secondDone && !popupVisible) {
            showPopup();
          }
          document.removeEventListener("click", handler);
        };

        document.addEventListener("click", handler);
        setTimeout(() => {
          document.removeEventListener("click", handler);
        }, CLICK_WINDOW);
      }

      function startFirstPopup() {
        setTimeout(() => {
          if (!firstDone) showPopup();
        }, FIRST_DELAY);
      }

      // ç­‰å¾… umi æ¸²æŸ“ç¨³å®šåå†å¯åŠ¨å¼¹çª—ï¼ˆé¿å… DOM æœªå‡†å¤‡å¥½ï¼‰
      document.addEventListener("DOMContentLoaded", () => {
        setTimeout(startFirstPopup, 2000);
      });

    })();
  </script>

  <!-- Cloudflare Insights -->
  <script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015"
          integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ=="
          data-cf-beacon='{"version":"2024.11.0","token":"ac8aa340be544d58b4d30fbcc83a6440"}'
          crossorigin="anonymous"></script>
</body>
</html>
